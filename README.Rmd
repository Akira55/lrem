---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->


取り敢えず、作業途中のものをおく。

テストコードは例えば、HansenのRBCのパラメータを用いれば、以下になる。

```{r, eval=FALSE}
E_ <- matrix(c( 1.       , 0.         , 0.        , 0.        ,  0.        ,
              0.         , -0.04384211, 0.06263158, 0.04384211, -1.05263158,
              0.         , 0.        ,  0.        , 0.        ,  0.        ,
              0.         , 1.        ,  0.        , 0.        ,  0.        ,
              0.         , 0.        ,  1.        , 0.        ,  0.        ),
            byrow = TRUE, nrow = 5)

A_ <- matrix(c(0.75          , 0         ,  0         ,  0         ,           0,
              1.             , 0.        ,  0.        ,  0.        , -1.05263158,
              1.             , 0.3       ,  1.        , -0.72012357, -1.       ,
              1.             , 1.05263158,  0.20877193,  0.14614035, -0.19877193,
              1.             , 0.        ,  0.95      ,  0.        ,  0.       ),
            byrow = TRUE, nrow = 5)
steps <- 200
t <- steps
x0 <- array(c(1,0,0), dim = c(3, 1))

lrem_result <- lre_auto(A_, E_, nx = 3, x0=x0)
out <- simulate(lrem_result$g, lrem_result$h, x0, t)

cb <- 0.5511920622464518
kb <- 2.772987427012156
nb <- 0.29583592293349903
zb <- 1.

pre <- 1:3

x <- out[,pre]

K1 <- kb +  x * kb
Z1 <- zb +  x * zb
N1 <- nb +  x * nb
C1 <- cb +  x * cb


plot(K1[,2])
plot(Z1[,2])
plot(N1[,2])
plot(C1[,2])


```
